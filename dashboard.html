<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; padding: 20px; }
    h1 { text-align: center; }
    .topbar { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; }
    button { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; background: #4CAF50; color: white; }
    button:hover { background: #45a049; }
    table { width: 100%; border-collapse: collapse; background: white; }
    th, td { padding: 10px; border: 1px solid #ddd; text-align: left; }
    th { background: #4CAF50; color: white; }
    #searchBar { width: 300px; padding: 8px; margin-bottom: 15px; }
  </style>
</head>
<body>

<h1>Admin Dashboard</h1>

<div class="topbar">
  <button onclick="window.location.href='index.html'">Register Student</button>
  <button onclick="window.location.href='search.html'">Search Student</button>
  <button onclick="logout()">Logout</button>
</div>

<input type="text" id="searchBar" placeholder="Search by name, phone or class..." onkeyup="filterTable()" />

<table id="dataTable">
  <thead>
    <tr>
      <th>Date</th>
      <th>Name</th>
      <th>Phone</th>
      <th>Class</th>
      <th>Salvation</th>
      <th>Temptation</th>
      <th>Prayers</th>
      <th>Bible</th>
      <th>Fellowship</th>
      <th>Witnessing</th>
      <th>Baptism</th>
      <th>Holy Spirit</th>
      <th>Giving</th>
      <th>Deliverance</th>
      <th>Evangelism</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxlozKnBF27UcbL_76dMfsGm_y_0JLASU3WxNAM2BIOD3QNTd2rH4PVJ8UdinTjoK7QWA/exec";

window.onload = function() {
  if (!sessionStorage.getItem("loggedIn")) {
    window.location.href = "login.html";
    return;
  }
  loadData();
};

function logout() {
  sessionStorage.removeItem("loggedIn");
  window.location.href = "login.html";
}

function loadData() {
  fetch("https://script.google.com/macros/s/AKfycbxlozKnBF27UcbL_76dMfsGm_y_0JLASU3WxNAM2BIOD3QNTd2rH4PVJ8UdinTjoK7QWA/exec?view=all")
    .then(res => res.json())
    .then(data => {
      let tableBody = document.querySelector("#dataTable tbody");
      tableBody.innerHTML = "";

      data.forEach(row => {
        let tr = document.createElement('tr');
        row.forEach(cell => {
          let td = document.createElement('td');
          td.textContent = cell;
          tr.appendChild(td);
        });
        tableBody.appendChild(tr);
      });
    })
    .catch(err => console.error("Error loading data:", err));
}

function filterTable() {
  let input = document.getElementById("searchBar").value.toLowerCase();
  let rows = document.querySelectorAll("#dataTable tbody tr");

  rows.forEach(r => {
    let text = r.textContent.toLowerCase();
    r.style.display = text.includes(input) ? "" : "none";
  });
}
</script>

</body>
</html>
